-- ----------------- LEVEL 3 : AGGREGATION --------------- --

-- Q1

SELECT COUNT(ORDER_ID) AS TOTAL_ORDER_PLACED FROM ORDERS;

-- Q2

SELECT SUM(TOTAL_AMOUNT) AS TOTAL_REVENUE FROM ORDERS; -- ALL THE ORDERS(CANCELLED ALSO INCLUDED)

-- Q3

SELECT ROUND(AVG(TOTAL_AMOUNT),2) AS AVG_ORDER_VALUE FROM ORDERS;

-- Q4

SELECT COUNT(CUSTOMER_ID) AS CUST_WITH_MIN_1_ORDER FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS);

-- Q5

SELECT CUSTOMER_ID, COUNT(ORDER_ID) AS 'NO. OF ORDER PLACED' FROM ORDERS GROUP BY CUSTOMER_ID;

-- Q6

SELECT CUSTOMERS.NAME, ORDERS.CUSTOMER_ID AS CUSTOMER_ID, SUM(ORDERS.TOTAL_AMOUNT) AS AMOUNT_SPEND 
FROM ORDERS INNER JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID GROUP BY CUSTOMER_ID;

-- Q7

SELECT products.CATEGORY AS PRODUCT_CATEGORY, SUM(order_items.QUANTITY) AS SOLD_QUANTITY
FROM products INNER JOIN order_items ON products.product_id = order_items.product_id GROUP BY CATEGORY;

-- Q8 

SELECT CATEGORY, avg(PRICE) AS AVG_PRICE FROM products group by category order by AVG_PRICE desc;

-- Q9 

SELECT dayname(order_date) AS DAY , count(order_id) AS "NO. OF ORDERS" FROM ORDERS group by DAY order by count(order_id) DESC;

-- Q10

SELECT METHOD AS PAYMENT_METHOD, COUNT(PAYMENT_ID) AS "NO. OF TIMES" FROM PAYMENTS GROUP BY METHOD ORDER BY COUNT(PAYMENT_ID) DESC;


-- ----------------- LEVEL 3 : AGGREGATION COMPLETED  --------------------- --

